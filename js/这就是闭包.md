## 什么是闭包
**闭包是指能在一个函数有权访问其它函数内部变量的函数。**
## 作用域链
在ES5中，有全局作用域和函数作用域，当访问一个变量时，解释器遵循就近原则，先在当前作用域寻找，
若没有，则往其父级寻找，其没有，再向上寻找，一直到全局作用域，形成的链式结构成为作用域链，和原型链类似。
```javascript
var i = 1;
var j = 1;
function f1(){
  var i = 2;
  function f2(){
    var i = 3
    console.log(i,j)
  }
  f2()
}
f1() // 3,1  
```
通过执行f1调用f2，f2访问i变量，在f2自身的作用域内有i变量，于是i为3，但f2作用域没有j变量，于是往其父级f1寻找，也没有，往上，到全局变量，存在，则j为1
## 如何产生闭包
开头提到：闭包是指能在一个函数有权访问其它函数内部变量的函数。能访问函数内部的变量的前提是有函数存在。\
js在执行上下文时遇到函数需要执行，就会形成私有作用域，当函数执行完毕后，就会释放函数的作用域，函数外部再也访问不了已经执行完函数内部的变量。\
当函数作用域内的变量被需要时，该函数就不会被销毁，一直被需要，则函数一直存在。
```javascript
function foo () {
  var i = 10;
  return function () {
    console.log(i)
    i ++
  }
}
var f = foo()  //产生闭包，此时函数foo不会被销毁，因为其内部的i变量被函数f需要
f()  //10  函数f可以访问foo内部的变量
```
当然，不一写要返回函数才能产生闭包，对函数内部的变量产生依赖需要就会产生闭包，比如将函数作为参数。
```javascript
var i = 1;
function foo (){
  var i = 2;
  function fn(){
    console.log(i)
  }
  f(fn)
}
function f(callback){
  console.log(i)  //1
  //产生闭包
  callback()  //2
}
foo()
```
通过调用foo执行f函数，f函数能先打印出1，访问的是全局变量的i，接着打印出2，访问的是foo函数内部的变量，这就产生了闭包.\
异步请求的回调函数即是闭包，如ajax的请求，事件的监听，定时器等，其回调即是闭包。
```javascript
function foo(){
  var i = 1;
  console.log(i)
}
document.addEventListener('scroll', foo); //滚动条滚动就会打印出1，但监听滚动条的函数能访问foo函数内部的变量
```
## 优缺点
**优点**
1. 可以重复使用变量，不会污染变量，及不同的闭包函数访问同一个函数作用域变量，其作用域变量对于两个函数来说不共享，都是相互独立的
2. 可以用来定义私有方法和私有变量

**缺点**\
产生闭包意味着有函数执行完但不能被销毁，所以会占用内存空间，造成卡顿，影响性能，ie下可能内存泄露，
因此产生闭包后，若确定该闭包函数在接下来不会继续使用，应将其指向null，释放内存空间
## 应用场景
1. 节流
2. 防抖
3. 函数柯里化
