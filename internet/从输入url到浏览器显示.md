## url到浏览器显示流程
用户输入url -> 浏览器进行dns解析 -> 建立tcp连接 -> 发送http请求 -> 接收服务端请求 -> 断开连接 -> 渲染页面
## 输入url
输入域名或ip，若浏览器有缓存过相似的域名或ip，浏览器则会推荐给用户选择
## DNS解析
域名其实就是ip的映射。
1、浏览器首先会在本地的hosts文件查找域名所对应的ip\
2、若hosts文件没有找到对应ip，则向本地DNS服务器发送请求(一般是接入网络的供应商，移动电信等)\
3、本地DNS服务器会在其缓存中查找域名对应的ip，若没有，本地DNS服务器会向DNS根服务器发送请求\
4、DNS根服务器并不会直接返回域名对应的ip，而是会返回顶级域(比如.com, .cn等)服务器的地址，让本地的DNS去顶级域服务器请求\
5、顶级域服务器也不会直接返回域名对应的ip，而是会返回解析该域名的服务器地址，让本地DNS去该服务器地址请求
6、本地DNS向域名服务器请求到对应的ip地址，并保存在缓存中，下次用户访问时，便可以直接返回
## 建立tcp连接
有了域名对应的ip后，浏览器则向服务器tcp连接请求，浏览器通过tcp的三次握手和服务端建立tcp连接。\
**三次握手**
- 第一次握手，客户端会发送一个SYN包和一个seq初始序列号x，发送完成后，客户端会进入SYN_SEND状态
- 第二次握手，服务端会发送一个ACK=x+1（确认包，就是客户端的seq+1），一个SYN包，一个seq=y, 服务端会进入SYN_REVD状态。第二次握手
其实验证了客户端的发送能力，服务端的接收和发送能力
- 第三次握手，客户端再次发送ACK=y+1（服务端的seq+1），客户端进入ESTABLISHED状态，准备发送数据。服务端收到ACK包后，进入ESTABLISHED状态，准备接受数据
三次握手结束,验证了客户端的接收能力
## 发送http请求
浏览器向服务端发起http请求，一般请求分三个部分\
请求方法URI协议/版本\
请求头\
请求正文
## 服务端处理请求
服务端收到请求后，通过http服务器处理请求（Apache, Nginx等），通过调用静态文件或读取数据库内容返回给浏览器
## 关闭http连接
双方都没有请求的交互后，为了节省资源，需要断开http连接，双方都可以发起断开连接的请求
**四次挥手**
- 第一次挥手，浏览器会发关一个FIN包，一个seq初始序列号，通知服务端浏览器不再发送数据，并进入FIN_WAIT_1状态
- 第二次挥手，服务端收到断开连接的请求后，会发送一个ACK包=x+1(确认包，值为浏览器发送的seq+1)，客浏览器收到服务端ACK包后，
进入FIN_WAIT_2状态
- 第三次挥手，服务端发送完ACK包给浏览器后，还可以继续向浏览器发送数据，浏览器也可以继续接受数据，待服务端发送完数据后，
准备关闭连接，服务端会发送一个FIN包，seq=y给浏览器，并进入LAST_ACK状态
- 第四次回收，浏览器收到服务端的FIN包后，再次发送ACK=y+1包给服务端，并进入TIME_WAIT状态，服务端收到ACK包后，断开连接，
进入CLOSED状态，浏览器在等待一段时间后没有收到服务端的响应，也断开连接，进入CLOSED状态
## 浏览器解析
浏览器解析html文件生成dom树，解析css生成css规则树，通过这两种树再生成渲染树，最后由浏览器渲染。
在解析html文件中，遇到js文件，解析html文件会停止，会出现js阻塞问题，所以js文件一般放文档后面
## 浏览器渲染
浏览器生成渲染树后，通过计算，调整每个盒子的大小和位置。盒子受到css或js的控制改变了样式，会引起回流(reflow)和重绘(repaint)\
当盒子的样式改变但不影响布局时，即发生了重绘(repaint)，一般是元素的颜色或背景发生了改变\
当盒子的样式改变且影响到布局时，需要重新计算盒子的大小位置，一般是大小发生了变化\
重绘会引发回流，回流不一定引发重绘


